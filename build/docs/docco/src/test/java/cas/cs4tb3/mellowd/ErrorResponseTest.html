<!DOCTYPE html>

<html>
<head>
  <title>Error Response Test</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="..\..\..\..\..\..\docco.css" />
</head>
<body>
<a href="https://github.com/SpencerPark/MellowD"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
  <div class="container">
    <div class="page">

      <div class="header">
        
          <div class="toctop" onclick="">
            <a class="source" href="..\..\..\..\..\..\index.html">Home</a>
            <h3>Table of Contents</h3>
              
                    
                    <div class="toc" onclick="">
                        <h3>src\main\antlr</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\antlr\MellowDLexer.html">
                                    MellowDLexer.g4
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\antlr\MellowDParser.html">
                                    MellowDParser.g4
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\ArticulatedSound.html">
                                    ArticulatedSound.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\Articulation.html">
                                    Articulation.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\Beat.html">
                                    Beat.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\Dynamic.html">
                                    Dynamic.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\Pitch.html">
                                    Pitch.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\PlayableSound.html">
                                    PlayableSound.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\TimingEnvironment.html">
                                    TimingEnvironment.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\compiler</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\Compiler.html">
                                    Compiler.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\MIDIIODelegate.html">
                                    MIDIIODelegate.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\SequenceIODelegate.html">
                                    SequenceIODelegate.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\SequencePlayer.html">
                                    SequencePlayer.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\TimeStampedMIDIMessage.html">
                                    TimeStampedMIDIMessage.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\VirtualMIDIPlayer.html">
                                    VirtualMIDIPlayer.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\compiler\WavIODelegate.html">
                                    WavIODelegate.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\midi</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\midi\GeneralMidiConstants.html">
                                    GeneralMidiConstants.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\midi\GeneralMidiInstrument.html">
                                    GeneralMidiInstrument.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\midi\GeneralMidiPercussion.html">
                                    GeneralMidiPercussion.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\midi\MidiNoteMessageSource.html">
                                    MidiNoteMessageSource.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\parser</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\Block.html">
                                    Block.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\BlockOptions.html">
                                    BlockOptions.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\IncorrectTypeException.html">
                                    IncorrectTypeException.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\ParseException.html">
                                    ParseException.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\SymbolTable.html">
                                    SymbolTable.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\TrackManager.html">
                                    TrackManager.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\parser\UndefinedReferenceException.html">
                                    UndefinedReferenceException.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\primitives</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\primitives\Chord.html">
                                    Chord.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\primitives\Melody.html">
                                    Melody.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\primitives\Phrase.html">
                                    Phrase.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\main\java\cas\cs4tb3\mellowd\primitives\Rhythm.html">
                                    Rhythm.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\java\cas\cs4tb3\mellowd</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="ChordResolutionTest.html">
                                    ChordResolutionTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="CompilerTest.html">
                                    CompilerTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="ErrorResponseTest.html">
                                    ErrorResponseTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="ParserTest.html">
                                    ParserTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="TestErrorListener.html">
                                    TestErrorListener.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\compilertest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\articulation.html">
                                    articulation.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\percussion.html">
                                    percussion.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\strangeChords.html">
                                    strangeChords.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\strangeMelodies.html">
                                    strangeMelodies.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\strangeRhythms.html">
                                    strangeRhythms.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\compilertest\varDeclarations.html">
                                    varDeclarations.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\errortest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\errortest\largeInput.html">
                                    largeInput.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\errortest\largeInputShared.html">
                                    largeInputShared.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\parsertest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\parsertest\chordNames.html">
                                    chordNames.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\parsertest\simpleBlock.html">
                                    simpleBlock.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\parsertest\varDeclaration.html">
                                    varDeclaration.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\testdata</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\testdata\CompilerTestData.html">
                                    CompilerTestData.json
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\resources\testdata\ParserTestData.html">
                                    ParserTestData.json
                                </a>
                            </li>
                        
                        </div>
                    
          </div>
        
            
            <!-- Moved TOC above header -->
            
          
          <h1 id="error-response-test">Error Response Test</h1>

          
            <div class='highlight'><pre>
<span class="hljs-keyword">package</span> cas.cs4tb3.mellowd;

<span class="hljs-keyword">import</span> cas.cs4tb3.mellowd.midi.GeneralMidiConstants;
<span class="hljs-keyword">import</span> cas.cs4tb3.mellowd.parser.*;
<span class="hljs-keyword">import</span> cas.cs4tb3.mellowd.parser.MellowDLexer;
<span class="hljs-keyword">import</span> cas.cs4tb3.mellowd.parser.MellowDParser;
<span class="hljs-keyword">import</span> org.antlr.v4.runtime.ANTLRFileStream;
<span class="hljs-keyword">import</span> org.antlr.v4.runtime.ANTLRInputStream;
<span class="hljs-keyword">import</span> org.antlr.v4.runtime.CommonTokenStream;
<span class="hljs-keyword">import</span> org.junit.Test;
<span class="hljs-keyword">import</span> org.junit.runner.RunWith;
<span class="hljs-keyword">import</span> org.junit.runners.JUnit4;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.assertTrue;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.fail;</pre></div>
          
        
      </div>

      
        
        <p>This class runs various tests with various erroneous inputs and verifying that
the compiler catches the issue and responds appropriately.</p>

        
          <div class='highlight'><pre><span class="hljs-meta">@RunWith</span>(JUnit4.class)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorResponseTest</span> </span>{</pre></div>
        
      
        
        <p>The tests will require the instantiation of quite a few parsers so we will define
some helper methods for creating parsers from a file input or a string.</p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MellowDParser <span class="hljs-title">parserFor</span><span class="hljs-params">(File input)</span> <span class="hljs-keyword">throws</span> IOException </span>{
        ANTLRFileStream inStream = <span class="hljs-keyword">new</span> ANTLRFileStream(input.getAbsolutePath());
        MellowDLexer lexer = <span class="hljs-keyword">new</span> MellowDLexer(inStream);
        CommonTokenStream tokenStream = <span class="hljs-keyword">new</span> CommonTokenStream(lexer);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MellowDParser(tokenStream, <span class="hljs-keyword">new</span> TimingEnvironment((<span class="hljs-keyword">byte</span>) <span class="hljs-number">4</span>, (<span class="hljs-keyword">byte</span>) <span class="hljs-number">4</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TrackManager(GeneralMidiConstants.REGULAR_CHANNELS, GeneralMidiConstants.DRUM_CHANNELS));
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MellowDParser <span class="hljs-title">parserFor</span><span class="hljs-params">(String input)</span> </span>{
        ANTLRInputStream inStream = <span class="hljs-keyword">new</span> ANTLRInputStream(input);
        MellowDLexer lexer = <span class="hljs-keyword">new</span> MellowDLexer(inStream);
        CommonTokenStream tokenStream = <span class="hljs-keyword">new</span> CommonTokenStream(lexer);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MellowDParser(tokenStream, <span class="hljs-keyword">new</span> TimingEnvironment((<span class="hljs-keyword">byte</span>) <span class="hljs-number">4</span>, (<span class="hljs-keyword">byte</span>) <span class="hljs-number">4</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TrackManager(GeneralMidiConstants.REGULAR_CHANNELS, GeneralMidiConstants.DRUM_CHANNELS));
    }</pre></div>
        
      
        
        <p>Verification of parse exceptions is a common task as well. For a parse exception to be expected
it must match the expected error text and position in the input.</p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">assertExpectedError</span><span class="hljs-params">(String expectedText, <span class="hljs-keyword">int</span> expectedStart, ParseException ex)</span> </span>{
        String failMsg = String.format(<span class="hljs-string">"Expected error \"%s\":%d but was \"%s\":%d."</span>,
                expectedText, expectedStart,
                ex.getText(), ex.getStart());
        assertTrue(failMsg,
                expectedStart == ex.getStart() &amp;&amp; expectedText.equals(ex.getText()));
        System.out.printf(<span class="hljs-string">"Successfully thrown exception: %s\n"</span>, ex.getMessage());
    }</pre></div>
        
      
        
        <p>Make sure the parser throws an error if a crescendo token
is not specified which would result in some sounds being skipped and
remaining in the buffer.</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">noTargetCrescendo</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    pp &lt;&lt; [a, b, c]*&lt;q&gt; "</span> +
                <span class="hljs-string">"}"</span>
        );
        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (ParseException e) {
            assertExpectedError(<span class="hljs-string">"&lt;&lt;"</span>, <span class="hljs-number">13</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Compiler did not throw an exception despite a crescendo with no target being specified."</span>);
    }</pre></div>
        
      
        
        <p>Make sure the compiler notices the block’s crescendo target is specified
even though it appears in the next fragment.</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">crescendoTargetNextFragment</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    pp &lt;&lt; [a, b, c]*&lt;q&gt; "</span> +
                <span class="hljs-string">"}block{"</span> +
                <span class="hljs-string">"    ff"</span> +
                <span class="hljs-string">"}"</span>);
        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (ParseException e) {
            fail(<span class="hljs-string">"Compiler threw an exception even though the crescendo was closed in the following block."</span>);
        }
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">crescendoToLowerDynamic</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    f &lt;&lt; [a]*&lt;q&gt; pp"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (ParseException e) {
            assertExpectedError(<span class="hljs-string">"&lt;&lt;"</span>, <span class="hljs-number">12</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Expected an error due to a crescendo being specified by the volume decreasing but nothing"</span> +
                <span class="hljs-string">"was thrown."</span>);
    }</pre></div>
        
      
        
        <p>Due to the GM specifications we are restricted in the number of channels available. If
an input contains too many different blocks such that they can not be properly distributed
amongst these channels an exception should be thrown explaining the problem.</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tooManyBlocks</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-keyword">new</span> File(Thread.currentThread().getContextClassLoader()
                .getResource(<span class="hljs-string">"errortest/largeInput.mlod"</span>).toURI().getPath()));

        <span class="hljs-keyword">boolean</span> encounteredException = <span class="hljs-keyword">false</span>;
        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IllegalStateException e) {
            encounteredException = <span class="hljs-keyword">true</span>;
        }

        <span class="hljs-keyword">if</span> (!encounteredException)
            fail(<span class="hljs-string">"Expected largeInput.mlod to throw an illegal state exception about too many channels but"</span> +
                    <span class="hljs-string">"it didn't."</span>);</pre></div>
        
      
        
        <p>Test to see if the sharechannel option can be used to fix the overloaded issue</p>

        
          <div class='highlight'><pre>        MellowDParser parserFix = parserFor(<span class="hljs-keyword">new</span> File(Thread.currentThread().getContextClassLoader()
                .getResource(<span class="hljs-string">"errortest/largeInputShared.mlod"</span>).toURI().getPath()));

        <span class="hljs-keyword">try</span> {
            parserFix.song();
        } <span class="hljs-keyword">catch</span> (IllegalStateException e) {
            fail(<span class="hljs-string">"Block2 sharing a channel with block1 did not fix the MIDI overload."</span>);
        }
    }</pre></div>
        
      
        
        <p>Test that various incorrect variable declarations and references are caught
and handled appropriately.</p>

        
      
        
        <p>Make sure that attempts to index a melody are caught</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">indexAMelody</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"myChord -&gt; [a, b, c]"</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    [myChord:0]*&lt;q&gt;"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"myChord"</span>, <span class="hljs-number">31</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Variable myChord was a melody when it should have been a chord to index but the compiler"</span> +
                <span class="hljs-string">"silently handled it."</span>);
    }</pre></div>
        
      
        
        <p>Make sure that attempts to make a phrase from a rhythm identifier starred with
a rhythm are caught.</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rhythmCrossRhythm</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"myChord -&gt; &lt;q, q, q&gt;"</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    myChord*&lt;q&gt;"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"myChord"</span>, <span class="hljs-number">30</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Variable myChord was a rhythm and the compiler silently starred it with a rhythm."</span>);
    }</pre></div>
        
      
        
        <p>Ensure attempts to use a melody identifier as a chord param are caught</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chordMelodyConcatenation</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"myChord -&gt; [a, b, c]"</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    (myChord, a)*&lt;q&gt;"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"myChord"</span>, <span class="hljs-number">31</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Variable myChord was a melody and the compiler silently accepted it as a chord parameter."</span>);
    }</pre></div>
        
      
        
        <p>Ensure the correct erroneous identifier is marked</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">secondIdentIncorrect</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"myMel -&gt; [a, b, c]"</span> +
                <span class="hljs-string">"myChord -&gt; (c, e, g)"</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    (myChord, myMel, a)*&lt;q&gt;"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"myMel"</span>, <span class="hljs-number">58</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Variable myMel was not marked as the problematic token."</span>);
    }</pre></div>
        
      
        
        <p>Ensure that implicit chords can be overridden</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">baseOverrideChord</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"C -&gt; [a, b, c]"</span> +
                <span class="hljs-string">"block{"</span> +
                <span class="hljs-string">"    (C, a)*&lt;q&gt;"</span> +
                <span class="hljs-string">"}"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"C"</span>, <span class="hljs-number">25</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Compiler used reassigned chord identifier as a chord despite being defined as a melody."</span>);
    }</pre></div>
        
      
        
        <p>Ensure that percussion mappings can be overwritten</p>

        
          <div class='highlight'><pre>    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">baseOverridePercussion</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        MellowDParser parser = parserFor(<span class="hljs-string">""</span> +
                <span class="hljs-string">"hHat -&gt; &lt;q&gt;"</span> +
                <span class="hljs-string">"sample -&gt;* [hHat, tri, lBongo]*&lt;q&gt;"</span>);

        <span class="hljs-keyword">try</span> {
            parser.song();
        } <span class="hljs-keyword">catch</span> (IncorrectTypeException e) {
            assertExpectedError(<span class="hljs-string">"hHat"</span>, <span class="hljs-number">23</span>, e);
            <span class="hljs-keyword">return</span>;
        }

        fail(<span class="hljs-string">"Compiler ignored redefined percussion sound hHat."</span>);

    }
}</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
