<!DOCTYPE html>

<html>
<head>
  <title>Symbol Table</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="..\..\..\..\..\..\..\docco.css" />
</head>
<body>
<a href="https://github.com/SpencerPark/MellowD"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
  <div class="container">
    <div class="page">

      <div class="header">
        
          <div class="toctop" onclick="">
            <a class="source" href="..\..\..\..\..\..\..\index.html">Home</a>
            <h3>Table of Contents</h3>
              
                    
                    <div class="toc" onclick="">
                        <h3>src\main\antlr</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\antlr\MellowDLexer.html">
                                    MellowDLexer.g4
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\antlr\MellowDParser.html">
                                    MellowDParser.g4
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\ArticulatedSound.html">
                                    ArticulatedSound.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\Articulation.html">
                                    Articulation.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\Beat.html">
                                    Beat.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\Dynamic.html">
                                    Dynamic.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\Pitch.html">
                                    Pitch.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\PlayableSound.html">
                                    PlayableSound.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\TimingEnvironment.html">
                                    TimingEnvironment.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\compiler</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\Compiler.html">
                                    Compiler.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\MIDIIODelegate.html">
                                    MIDIIODelegate.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\SequenceIODelegate.html">
                                    SequenceIODelegate.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\SequencePlayer.html">
                                    SequencePlayer.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\TimeStampedMIDIMessage.html">
                                    TimeStampedMIDIMessage.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\VirtualMIDIPlayer.html">
                                    VirtualMIDIPlayer.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\compiler\WavIODelegate.html">
                                    WavIODelegate.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\midi</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\midi\GeneralMidiConstants.html">
                                    GeneralMidiConstants.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\midi\GeneralMidiInstrument.html">
                                    GeneralMidiInstrument.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\midi\GeneralMidiPercussion.html">
                                    GeneralMidiPercussion.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\midi\MidiNoteMessageSource.html">
                                    MidiNoteMessageSource.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\parser</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="Block.html">
                                    Block.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="BlockOptions.html">
                                    BlockOptions.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="IncorrectTypeException.html">
                                    IncorrectTypeException.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="ParseException.html">
                                    ParseException.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="SymbolTable.html">
                                    SymbolTable.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="TrackManager.html">
                                    TrackManager.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="UndefinedReferenceException.html">
                                    UndefinedReferenceException.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\main\java\cas\cs4tb3\mellowd\primitives</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\primitives\Chord.html">
                                    Chord.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\primitives\Melody.html">
                                    Melody.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\primitives\Phrase.html">
                                    Phrase.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\primitives\Rhythm.html">
                                    Rhythm.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\java\cas\cs4tb3\mellowd</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\java\cas\cs4tb3\mellowd\ChordResolutionTest.html">
                                    ChordResolutionTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\java\cas\cs4tb3\mellowd\CompilerTest.html">
                                    CompilerTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\java\cas\cs4tb3\mellowd\ErrorResponseTest.html">
                                    ErrorResponseTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\java\cas\cs4tb3\mellowd\ParserTest.html">
                                    ParserTest.java
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\java\cas\cs4tb3\mellowd\TestErrorListener.html">
                                    TestErrorListener.java
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\compilertest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\articulation.html">
                                    articulation.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\percussion.html">
                                    percussion.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\strangeChords.html">
                                    strangeChords.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\strangeMelodies.html">
                                    strangeMelodies.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\strangeRhythms.html">
                                    strangeRhythms.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\compilertest\varDeclarations.html">
                                    varDeclarations.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\errortest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\errortest\largeInput.html">
                                    largeInput.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\errortest\largeInputShared.html">
                                    largeInputShared.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\parsertest</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\parsertest\chordNames.html">
                                    chordNames.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\parsertest\simpleBlock.html">
                                    simpleBlock.mlod
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\parsertest\varDeclaration.html">
                                    varDeclaration.mlod
                                </a>
                            </li>
                        
                        </div>
                    
                    <div class="toc" onclick="">
                        <h3>src\test\resources\testdata</h3>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\testdata\CompilerTestData.html">
                                    CompilerTestData.json
                                </a>
                            </li>
                        
                            <li class="tocelem">
                                <a class="source" href="..\..\..\..\..\..\test\resources\testdata\ParserTestData.html">
                                    ParserTestData.json
                                </a>
                            </li>
                        
                        </div>
                    
          </div>
        
            
            <!-- Moved TOC above header -->
            
          
          <h1 id="symbol-table">Symbol Table</h1>

          
            <div class='highlight'><pre>
<span class="hljs-keyword">package</span> cas.cs4tb3.mellowd.parser;

<span class="hljs-keyword">import</span> org.antlr.v4.runtime.Token;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;</pre></div>
          
        
      </div>

      
        
        <p>A symbol table holds references. It is simply a Map at its core but it provides type
and exception handling functionality. The <code>@SuppressWarnings(&quot;unchecked&quot;)</code> stops the compiler
from incorrectly warning about unchecked casts as the check is done via reflection and the
compiler isnâ€™t convinced that it has been checked.</p>

        
          <div class='highlight'><pre><span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SymbolTable</span> </span>{</pre></div>
        
      
        
        <p>The <code>declarations</code> are the actually <code>name -&gt; value</code> mappings.</p>

        
          <div class='highlight'><pre>    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; declarations;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SymbolTable</span><span class="hljs-params">()</span> </span>{
        declarations = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
    }</pre></div>
        
      
        
        <p><code>addDeclaration</code> is the only data input method for this class. It adds a
new mapping for the <code>identifier</code> to the <code>value</code>. It will overwrite an existing
data and will return true if it does so.</p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">addDeclaration</span><span class="hljs-params">(String identifier, Object value)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.declarations.put(identifier, value) != <span class="hljs-keyword">null</span>;
    }</pre></div>
        
      
        
        <p><code>getDeclarationValue</code> is the based data output method for this class. It takes
the name of the <code>identifier</code> to lookup and the expected type. If the value
does not exist this method simply returns null. If the value exists but is the wrong type
this method will treat the identifier as non-existent and return null. Otherwise the
value is returned.</p>

        
          <div class='highlight'><pre>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">getDeclarationValue</span><span class="hljs-params">(String identifier, Class&lt;T&gt; type)</span> </span>{
        Object value = declarations.get(identifier);
        <span class="hljs-keyword">return</span> type.isInstance(value) ? (T) value : <span class="hljs-keyword">null</span>;
    }</pre></div>
        
      
        
        <p><code>getDeclarationValueOrThrow</code> is similar in function to <code>getDeclarationValue</code> but instead
of returning null, the appropriate exception will be thrown.</p>

        
          <div class='highlight'><pre>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">getDeclarationValueOrThrow</span><span class="hljs-params">(Token token, Class&lt;T&gt; type)</span> </span>{
        Object value = declarations.get(token.getText());</pre></div>
        
      
        
        <p>If the value is null then there is nothing defined so throw an
<a href="UndefinedReferenceException.html">UndefinedReferenceException</a>.</p>

        
          <div class='highlight'><pre>        <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UndefinedReferenceException(token, <span class="hljs-string">"Identifier ("</span>+token.getText()+<span class="hljs-string">") is undefined."</span>);</pre></div>
        
      
        
        <p>If the type of the value is incorrect then something is defined but it is the wrong type
so throw an <a href="IncorrectTypeException.html">IncorrectTypeException</a>.</p>

        
          <div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!type.isInstance(value))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IncorrectTypeException(token, <span class="hljs-string">"Identifier ("</span>+token.getText()+<span class="hljs-string">") points to a "</span>+value.getClass().getSimpleName()+<span class="hljs-string">" not a "</span>+type.getSimpleName());</pre></div>
        
      
        
        <p>Otherwise all is fine so we can safely cast and return the value</p>

        
          <div class='highlight'><pre>        <span class="hljs-keyword">return</span> (T) value;
    }</pre></div>
        
      
        
        <p><code>getType</code> is a utility method that will return the type of the data. This
will return null if the identifier is not defined.</p>

        
          <div class='highlight'><pre>    <span class="hljs-keyword">public</span> Class&lt;?&gt; getType(String identifier) {
        Object value = declarations.get(identifier);
        <span class="hljs-keyword">return</span> value == <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">null</span> : value.getClass();
    }</pre></div>
        
      
        
        <p><code>identifierTypeIs</code> preforms a type check on the identifier. It
will return true if the identifier is defined and points to an object
that can safely be cast to <code>type</code></p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">identifierTypeIs</span><span class="hljs-params">(String identifier, Class&lt;?&gt; type)</span> </span>{
        Object value = declarations.get(identifier);
        <span class="hljs-keyword">return</span> value != <span class="hljs-keyword">null</span> &amp;&amp; type.isAssignableFrom(value.getClass());
    }</pre></div>
        
      
        
        <p><code>checkType</code> is the equivalent of <code>identifierTypeIs</code> throwing an exception
if the type is defined and incorrect (not able to be cast to <code>type</code>).</p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">checkType</span><span class="hljs-params">(Token token, Class&lt;?&gt; type)</span> </span>{
        Object value = declarations.get(token.getText());
        <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span> &amp;&amp; !type.isAssignableFrom(value.getClass()))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IncorrectTypeException(token, <span class="hljs-string">"Identifier ("</span> + token.getText() + <span class="hljs-string">") points to a "</span> + value.getClass().getSimpleName() + <span class="hljs-string">" not a "</span> + type.getSimpleName());
    }</pre></div>
        
      
        
        <p><code>checkExists</code> is a utility method that throws an exception if the identifier that
the <code>token</code> points to is not defined.</p>

        
          <div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">checkExists</span><span class="hljs-params">(Token token)</span> </span>{
        Object value = declarations.get(token.getText());
        <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UndefinedReferenceException(token, <span class="hljs-string">"Identifier ("</span>+token.getText()+<span class="hljs-string">") is undefined."</span>);
    }
}</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
